# 구현 현황 분석

> PRD 대비 현재 구현 상태 비교 분석
> 작성일: 2025-12-14
> Phase 3 온보딩 완료 시점

---

## 1. 개요

이 문서는 PRD.md에 정의된 요구사항과 실제 구현된 내용을 비교하여, 의도적으로 단순화하거나 미구현된 부분을 정리합니다.

---

## 2. 온보딩 플로우 (Phase 3)

### 2.1 구현 완료

| 기능 | 상태 | 비고 |
|-----|------|------|
| 프로필 설정 (닉네임) | ✅ 완료 | |
| 아이 등록 (이름, 생년월일, 성별) | ✅ 완료 | |
| 가족 자동 생성 | ✅ 완료 | |
| 초대 링크 생성 | ✅ 완료 | |
| 초대 링크 표시 | ✅ 완료 | |

### 2.2 의도적 단순화

#### 2.2.1 이용약관 동의 미구현

**PRD 요구사항:**
```
온보딩 Step 1: 서비스 이용약관, 개인정보 처리방침 동의
- 필수 동의: 이용약관, 개인정보 처리방침
- 선택 동의: 마케팅 정보 수신
```

**현재 상태:** 미구현

**이유:**
- MVP 단계에서 법적 문서 준비 필요
- 추후 법무 검토 후 구현 예정

**구현 시 필요 작업:**
- [ ] User 모델에 `terms_agreed_at`, `privacy_agreed_at`, `marketing_agreed_at` 필드 추가
- [ ] 이용약관 동의 페이지 구현
- [ ] 약관 내용 작성

---

#### 2.2.2 프로필 아바타 업로드 미구현

**PRD 요구사항:**
```
프로필 설정: 닉네임 입력 + 프로필 사진 (선택)
```

**현재 상태:** 닉네임만 구현, 아바타 미구현

**이유:**
- Active Storage 이미지 처리는 Photo 모델에서 검증 예정
- 온보딩 단순화를 위해 선택 기능 제외

**구현 시 필요 작업:**
- [ ] User 모델에 `has_one_attached :avatar` 추가
- [ ] 프로필 폼에 아바타 업로드 필드 추가
- [ ] 아바타 variant 설정 (썸네일)

---

#### 2.2.3 가족 내 관계 설정 미구현

**PRD 요구사항:**
```
아이와의 관계: 엄마, 아빠, 할머니, 할아버지, 이모/고모, 삼촌/외삼촌, 기타
```

**현재 상태:** FamilyMembership에 role만 있음 (owner, admin, member, viewer)

**이유:**
- role은 권한 관리용
- 관계(relation)는 표시용으로 별도 필드 필요
- MVP에서는 권한 관리만 우선 구현

**구현 시 필요 작업:**
- [ ] FamilyMembership에 `relation` enum 추가 (mom, dad, grandma, grandpa, aunt, uncle, other)
- [ ] 온보딩에 관계 선택 단계 추가
- [ ] 설정에서 관계 변경 기능 추가

---

#### 2.2.4 온보딩 완료 상태 추적 미구현

**PRD 요구사항:**
```
온보딩 완료 후 대시보드로 이동
미완료 시 해당 단계로 리다이렉트
```

**현재 상태:** 온보딩 완료 여부 추적 없음

**이유:**
- 각 단계 간 자유로운 이동 허용
- 단순한 플로우 우선 구현

**구현 시 필요 작업:**
- [ ] User 모델에 `onboarding_completed_at` 필드 추가
- [ ] ApplicationController에 온보딩 상태 체크 로직 추가
- [ ] 각 온보딩 단계 완료 시 상태 업데이트

---

#### 2.2.5 초대 링크 공유 방식 단순화

**PRD 요구사항:**
```
공유 방식: 카카오톡 공유, 링크 복사, QR 코드
```

**현재 상태:** 링크 복사만 구현

**이유:**
- 카카오톡 공유: 카카오 JavaScript SDK 연동 필요
- QR 코드: 추가 라이브러리 필요
- MVP에서는 가장 범용적인 링크 복사만 구현

**구현 시 필요 작업:**
- [ ] 카카오톡 공유 버튼 추가 (Kakao.Link.sendDefault)
- [ ] QR 코드 생성 gem 추가 (rqrcode)
- [ ] QR 코드 표시 UI 구현

---

#### 2.2.6 초대 링크 재사용 미구현

**PRD 요구사항:**
```
초대 링크는 7일간 유효
같은 초대 링크로 여러 명 가입 가능 (옵션)
```

**현재 상태:** 페이지 접근 시마다 새 초대 생성

**이유:**
- 단순한 구현 우선
- 초대 관리 UI 없이 매번 새로 생성

**구현 시 필요 작업:**
- [ ] 기존 유효한 초대가 있으면 재사용
- [ ] 초대 목록 조회/삭제 기능 추가
- [ ] 초대 만료 시 새로 생성

---

## 3. 인증 시스템 (Phase 2)

### 3.1 의도적 단순화

#### 3.1.1 Apple/Google 로그인 미구현

**PRD 요구사항:**
```
지원 OAuth: 카카오, 애플, 구글
```

**현재 상태:** 카카오만 구현

**이유:**
- 카카오가 한국 시장 주요 타겟
- Apple/Google은 추후 확장

**구현 시 필요 작업:**
- [ ] omniauth-apple gem 추가
- [ ] omniauth-google-oauth2 gem 추가
- [ ] Apple/Google 개발자 계정 설정
- [ ] 로그인 화면에 버튼 추가

---

## 4. 다음 단계 권장 사항

### 4.1 즉시 필요 (Phase 4 시작 전)

1. **온보딩 완료 추적**: 사용자가 온보딩을 완료했는지 확인하는 로직 필요
2. **초대 수락 컨트롤러**: `InvitationsController#show` 구현 필요 (현재 라우트만 있음)

### 4.2 MVP 출시 전 필요

1. **이용약관 동의**: 법적 요구사항
2. **프로필 아바타**: 사용자 식별 용이성
3. **가족 내 관계**: 앱 특성상 중요한 기능

### 4.3 출시 후 개선

1. **Apple/Google 로그인**: 사용자 편의성
2. **카카오톡 공유**: 바이럴 효과
3. **QR 코드**: 오프라인 공유

---

## 5. 기술 부채 (Technical Debt)

| 항목 | 현재 상태 | 개선 필요 |
|-----|----------|----------|
| 초대 생성 로직 | 매번 새 초대 생성 | 기존 초대 재사용 |
| 온보딩 순서 | 강제 없음 | 순서 강제 또는 완료 추적 |
| 에러 처리 | 기본 Rails 에러 | 사용자 친화적 메시지 |
| 뷰 디자인 | 기본 HTML | TailwindCSS 스타일링 |

---

## 변경 이력

| 날짜 | 내용 |
|-----|------|
| 2025-12-14 | 최초 작성 (Phase 3 완료 시점) |
