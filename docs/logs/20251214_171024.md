# Claude Code 세션 로그

| 항목 | 값 |
|------|-----|
| 날짜 | 2025-12-14 07:55 |
| 프로젝트 | moabom |
| 브랜치 | main |
| Claude Code | 2.0.69 |

---

## 1. 프롬프트

다른 사람들은 hooks를 어떻게 사용하는지 레퍼런스를 찾아줘

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
사용자가 Claude Code의 hooks 기능에 대한 레퍼런스를 찾아달라고 요청하고 있습니다. 이것은 Claude Code 기능에 대한 질문이므로, claude-code-guide 에이전트를 사용해야 합니다.
```

</details>



---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
The agent provided a comprehensive guide about Claude Code hooks. Let me summarize the key information for the user in Korean since they asked in Korean.
```

</details>



---

### 응답

## Claude Code Hooks 가이드

### Hooks란?

Claude Code의 특정 시점에 자동으로 실행되는 **사용자 정의 쉘 명령**입니다. LLM에 의존하지 않고 결정론적으로 동작을 제어할 수 있습니다.

---

### 설정 위치

```
1. .claude/settings.local.json  # 로컬 (커밋 제외)
2. .claude/settings.json        # 프로젝트별
3. ~/.claude/settings.json      # 전역
```

쉬운 설정: `/hooks` 명령어로 인터랙티브 메뉴 사용

---

### Hook 이벤트 종류

| 이벤트 | 트리거 시점 | 블로킹 |
|--------|------------|--------|
| `PreToolUse` | 도구 실행 전 | ✅ |
| `PostToolUse` | 도구 실행 후 | ❌ |
| `UserPromptSubmit` | 사용자 입력 전 | ✅ |
| `Stop` | Claude 응답 완료 | ✅ |
| `SessionStart` | 세션 시작 | ❌ |
| `SessionEnd` | 세션 종료 | ❌ |

---

### 실제 사용 예시

**1. Ruby 파일 자동 포맷팅** (PostToolUse)
```json
{
  "hooks": {
    "PostToolUse": [{
      "matcher": "Write|Edit",
      "hooks": [{
        "type": "command",
        "command": "file_path=$(jq -r '.tool_input.file_path'); if [[ \"$file_path\" == *.rb ]]; then rubocop -a \"$file_path\" 2>/dev/null || true; fi"
      }]
    }]
  }
}
```

**2. 민감한 파일 수정 차단** (PreToolUse)
```json
{
  "hooks": {
    "PreToolUse": [{
      "matcher": "Edit|Write",
      "hooks": [{
        "type": "command",
        "command": "python3 -c \"import json,sys; data=json.load(sys.stdin); path=data.get('tool_input',{}).get('file_path',''); sys.exit(2 if '.env' in path or '.git/' in path else 0)\""
      }]
    }]
  }
}
```
> Exit code 2 = 블로킹

**3. 데스크톱 알림** (Notification)
```json
{
  "hooks": {
    "Notification": [{
      "matcher": "permission_prompt",
      "hooks": [{
        "type": "command",
        "command": "osascript -e 'display notification \"입력 대기 중\" with title \"Claude Code\"'"
      }]
    }]
  }
}
```

**4. Bash 명령 로깅**
```bash
jq -r '.tool_input.command' >> ~/.claude/bash-log.txt
```

**5. 세션 시작 시 환경 설정** (SessionStart)
```bash
#!/bin/bash
source ~/.nvm/nvm.sh && nvm use 20
if [ -n "$CLAUDE_ENV_FILE" ]; then
  echo "export NODE_ENV=development" >> "$CLAUDE_ENV_FILE"
fi
```

---

### Hook 입출력

**입력** (stdin으로 JSON 수신):
```json
{
  "session_id": "abc123",
  "tool_name": "Write",
  "tool_input": { "file_path": "/path/file.rb" },
  "cwd": "/project/dir"
}
```

**출력** (exit code):
- `0`: 성공 (JSON으로 수정된 입력 반환 가능)
- `2`: 블로킹 (stderr가 Claude에게 표시됨)

---

### Best Practices

1. **변수 항상 인용**: `"$VAR"` 사용
2. **특정 matcher 사용**: `*` 대신 `Write|Edit`
3. **스크립트는 `.claude/hooks/`에 저장**
4. **`$CLAUDE_PROJECT_DIR` 활용**
5. **수동 테스트 후 등록**

---

현재 프로젝트의 `.claude/settings.json`에서 이미 RuboCop 자동 포맷팅 hook이 설정되어 있습니다.

---

## 3. 프롬프트

다른 회사에서는 어떻게 사용하는지 웹 검색을 통해 알아봐줘. 특히 유튜브나 블로그에서 소개하는 방법도 찾아봐

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
사용자가 Claude Code hooks를 다른 회사나 개발자들이 어떻게 사용하는지 실제 사례를 웹 검색으로 찾아달라고 요청하고 있습니다. 유튜브와 블로그 등의 실제 사용 사례를 찾아봐야 합니다.
```

</details>



---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
좋은 검색 결과를 얻었습니다. 이제 한국어 블로그나 유튜브도 검색해보겠습니다.
```

</details>



---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
GitButler 블로그가 너무 길어서 fetch가 안 됐네요. 다른 흥미로운 블로그들을 더 찾아보겠습니다.
```

</details>



---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
좋은 정보를 많이 얻었습니다. 이제 haihai.ai 블로그도 확인해보고, 종합해서 사용자에게 제공하겠습니다.
```

</details>



---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
충분한 정보를 수집했습니다. 이제 사용자에게 종합적인 정보를 한국어로 정리해서 제공하겠습니다.
```

</details>



---

### 응답

## Claude Code Hooks 실제 사용 사례 모음

검색 결과를 바탕으로 다양한 회사와 개발자들의 hooks 활용 사례를 정리했습니다.

---

### 🏢 회사/팀 사례

#### 1. GitButler - 자동 Git 커밋
세션 종료 시 자동으로 커밋을 생성하고, 여러 세션을 다른 브랜치에서 관리합니다.

```json
{
  "hooks": {
    "SessionEnd": [{
      "hooks": [{
        "type": "command",
        "command": "git add -A && git commit -m 'Claude session auto-commit'"
      }]
    }]
  }
}
```
> 출처: [GitButler Blog](https://blog.gitbutler.com/automate-your-ai-workflows-with-claude-code-hooks)

#### 2. 테스트 통과 전 커밋 차단
PreToolUse로 `git commit`을 감싸서, 테스트 통과 여부를 확인하는 파일이 없으면 커밋을 차단합니다.

```bash
# /tmp/agent-pre-commit-pass 파일이 있어야만 커밋 허용
if [ ! -f /tmp/agent-pre-commit-pass ]; then
  echo "Tests must pass before committing" >&2
  exit 2
fi
```
> 출처: [Anthropic Engineering Blog](https://www.anthropic.com/engineering/claude-code-best-practices)

---

### 🎨 창의적 사용 사례

#### 3. 소리 알림 시스템 (haihai.ai)
작업별로 다른 소리를 재생하는 Python 핸들러:

| 이벤트 | 소리 |
|--------|------|
| 파일 편집 | "edit" 🔊 |
| Git 커밋 | "commit" 🔊 |
| 테스트 실행 | "test" 🔊 |
| PR 생성 | "pr" 🔊 |
| 작업 완료 | "ready" 🔊 |

```python
# macOS에서 소리 재생
subprocess.Popen(['afplay', sound_path], 
                 stdout=subprocess.DEVNULL, 
                 stderr=subprocess.DEVNULL)
```
> 출처: [haihai.ai - Make Claude Code Meow](https://www.haihai.ai/hooks/)

#### 4. TTS 음성 안내 (StackToHeap)
작업 완료 시 음성으로 알려주는 Hook:

```bash
say "Claude has finished the task"  # macOS
# 또는
espeak "Task completed"  # Linux
```
> 출처: [StackToHeap Blog](https://stacktoheap.com/blog/2025/08/03/having-fun-with-claude-code-hooks/)

---

### 🛡️ 보안 사례

#### 5. 위험 명령어 차단 (claude-code-hooks-mastery)

```python
dangerous_patterns = [
    r'rm\s+.*-[rf]',      # rm -rf 차단
    r'sudo\s+rm',         # sudo rm 차단
    r'chmod\s+777',       # 위험한 권한 차단
    r'>\s*/etc/',         # 시스템 디렉토리 쓰기 차단
]

if any(re.search(p, command) for p in dangerous_patterns):
    print("BLOCKED: Dangerous command", file=sys.stderr)
    sys.exit(2)
```
> 출처: [GitHub - claude-code-hooks-mastery](https://github.com/disler/claude-code-hooks-mastery)

#### 6. 민감 파일 보호
`.env`, `.git/`, `package-lock.json` 수정 차단:

```python
protected_paths = ['.env', '.git/', 'package-lock.json', 'credentials']
if any(p in file_path for p in protected_paths):
    sys.exit(2)  # 차단
```

---

### 🇰🇷 한국어 리소스

#### 7. 한국 개발 환경 맞춤 인프라 (serithemage)
프로덕션에서 검증된 Claude Code 인프라:

**필수 Hooks 2개:**
- `skill-activation-prompt`: 키워드 기반 자동 스킬 제안
- `post-tool-use-tracker`: 수정 파일 추적 및 추가 스킬 제안

**효과:** 40-60% 토큰 효율 향상
> 출처: [GitHub - claude-code-infrastructure-showcase (한국어)](https://github.com/serithemage/claude-code-infrastructure-showcase)

#### 8. Claude Code 마스터링 가이드북
한국어로 작성된 완전 가이드:
> 출처: [Claude Code 마스터링](https://revfactory.github.io/claude-code-mastering)

---

### 📋 일반적인 활용 패턴

#### 9. 언어별 자동 포맷팅

```json
{
  "hooks": {
    "PostToolUse": [{
      "matcher": "Write|Edit",
      "hooks": [{
        "type": "command",
        "command": "case \"$file_path\" in *.py) black \"$file_path\";; *.ts|*.js) prettier -w \"$file_path\";; *.go) gofmt -w \"$file_path\";; *.rb) rubocop -a \"$file_path\";; esac"
      }]
    }]
  }
}
```
> 출처: [Velog - Claude Code Hooks 완벽 가이드](https://velog.io/@csk917work/Claude-Code-Hooks-완벽-가이드-개발자의-새로운-슈퍼파워)

#### 10. 완료 전 품질 체크 (Stop Hook)

```python
# 테스트가 모두 통과해야만 작업 완료 허용
if not all_tests_passed():
    output = {
        "decision": "block",
        "reason": "Tests failing—fix before completing"
    }
    print(json.dumps(output))
    sys.exit(0)
```

---

### 📺 영상 튜토리얼

- [Geeky Gadgets - Claude Code Hooks Tutorial](https://www.geeky-gadgets.com/claude-code-hooks-automation-tutorial/) (YouTube 포함)
- [claude-code-hooks-mastery GitHub](https://github.com/disler/claude-code-hooks-mastery) - Sub-agents 영상 포함

---

### 🔑 핵심 Exit Code 규칙

| Exit Code | 의미 | 사용 |
|-----------|------|------|
| `0` | 성공 | 정상 진행 |
| `2` | 차단 | 도구 실행 방지, stderr를 Claude에게 전달 |
| 기타 | 경고 | 진행하되 경고 표시 |

---

**Sources:**
- [GitButler Blog](https://blog.gitbutler.com/automate-your-ai-workflows-with-claude-code-hooks)
- [claude-code-hooks-mastery](https://github.com/disler/claude-code-hooks-mastery)
- [haihai.ai](https://www.haihai.ai/hooks/)
- [StackToHeap Blog](https://stacktoheap.com/blog/2025/08/03/having-fun-with-claude-code-hooks/)
- [Velog 한국어 가이드](https://velog.io/@csk917work/Claude-Code-Hooks-완벽-가이드-개발자의-새로운-슈퍼파워)
- [한국어 인프라 저장소](https://github.com/serithemage/claude-code-infrastructure-showcase)
- [Claude Code 마스터링](https://github.com/revfactory/claude-code-mastering)
- [Anthropic Best Practices](https://www.anthropic.com/engineering/claude-code-best-practices)

---

## 6. 프롬프트

내 프로젝트에 맞는 hooks 설정 추천해줘

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
사용자가 자신의 프로젝트(모아봄 - Rails 8.1 + Hotwire + TailwindCSS 기반 가족 아기 사진첩 앱)에 맞는 hooks 설정을 추천해달라고 요청하고 있습니다.

먼저 현재 프로젝트의 hooks 설정을 확인하고, 프로젝트 특성에 맞는 hooks를 추천해야 합니다.

프로젝트 특성:
- Rails 8.1 + Hotwire (Turbo + Stimulus) + TailwindCSS
- SQLite (Solid Cache/Queue/Cable)
- Turbo Native (iOS/Android)
- TDD 워크플로우 사용 (plan.md)
- RuboCop 사용

현재 설정을 먼저 확인해보겠습니다.
```

</details>



---

### 응답

현재 프로젝트 설정을 먼저 확인하겠습니다.

---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
현재 프로젝트 설정을 확인했습니다. 이제 기존 hooks 설정을 확인해보겠습니다.
```

</details>



---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
이제 프로젝트의 현재 상태를 파악했습니다:

**현재 hooks 설정:**
1. PostToolUse: Ruby 파일 편집 시 rubocop -a 자동 실행
2. Stop: macOS 알림 (작업 완료)
3. SessionEnd: 세션 로그를 docs/logs에 저장

**프로젝트 특성:**
- Rails 8.1 + Hotwire + TailwindCSS
- TDD 워크플로우 (plan.md 사용)
- 커밋 규칙: type(scope): subject
- 테스트: rails test, rubocop
- 커밋 전 체크리스트: 테스트 통과, rubocop, 디버그 코드 없음

이제 이 프로젝트에 맞는 추가 hooks를 추천하겠습니다:

1. **PreToolUse - git commit 전 테스트/린트 체크**: 테스트가 통과해야만 커밋 허용
2. **PostToolUse - ERB 파일 검증**: erb-lint 또는 HTML 검증
3. **PreToolUse - 민감 파일 보호**: .env, credentials, master.key 보호
4. **PostToolUse - JS 파일 포맷팅**: Stimulus 컨트롤러 등
5. **UserPromptSubmit - TDD 컨텍스트 주입**: plan.md 상태 확인
6. **PreToolUse - 디버그 코드 차단**: binding.pry, debugger, puts 등 포함된 파일 쓰기 차단
 
구체적인 hook 설정을 준비하고 세부 구현 방안을 정리할 준비가 되었습니다. 각 hook의 목적과 실행 조건을 명확히 정의하여 개발 워크플로우를 최적화하겠습니다.
```

</details>



---

### 응답

현재 설정을 분석했습니다. 모아봄 프로젝트에 맞는 추가 hooks를 추천드립니다.

## 현재 설정 분석

**이미 있는 hooks:**
- ✅ Ruby 파일 자동 RuboCop 포맷팅
- ✅ 작업 완료 macOS 알림
- ✅ 세션 로그 저장

## 추천 Hooks 설정

### 1. 커밋 전 테스트/린트 체크 (핵심!)

CLAUDE.md의 "Before Committing" 규칙을 강제합니다.

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "command=$(jq -r '.tool_input.command'); if echo \"$command\" | grep -qE '^git commit'; then cd \"$CLAUDE_PROJECT_DIR\" && rails test --fail-fast 2>/dev/null && rubocop --fail-level E 2>/dev/null || { echo '❌ 테스트 또는 RuboCop 실패. 커밋 전 수정 필요.' >&2; exit 2; }; fi"
          }
        ]
      }
    ]
  }
}
```

### 2. 디버그 코드 차단

`binding.pry`, `debugger`, `puts` 등이 포함된 Ruby 파일 작성 차단:

```json
{
  "matcher": "Write|Edit",
  "hooks": [
    {
      "type": "command",
      "command": "content=$(jq -r '.tool_input.content // .tool_input.new_string // \"\"'); file_path=$(jq -r '.tool_input.file_path'); if [[ \"$file_path\" == *.rb ]] && echo \"$content\" | grep -qE 'binding\\.pry|debugger|byebug|puts\\s|p\\s+[^u]'; then echo '❌ 디버그 코드 감지: binding.pry, debugger, puts 등 제거 필요' >&2; exit 2; fi"
    }
  ]
}
```

### 3. 민감 파일 보호

`.env`, `credentials`, `master.key` 수정 차단:

```json
{
  "matcher": "Write|Edit",
  "hooks": [
    {
      "type": "command",
      "command": "file_path=$(jq -r '.tool_input.file_path'); if echo \"$file_path\" | grep -qE '\\.env|credentials\\.yml|master\\.key|secrets\\.yml'; then echo '❌ 민감 파일 수정 차단: $file_path' >&2; exit 2; fi"
    }
  ]
}
```

### 4. ERB/JS 파일 자동 포맷팅

```json
{
  "matcher": "Write|Edit",
  "hooks": [
    {
      "type": "command",
      "command": "file_path=$(jq -r '.tool_input.file_path'); case \"$file_path\" in *.erb) erb -x -T - \"$file_path\" >/dev/null 2>&1 || echo 'ERB 구문 경고' >&2;; *.js) npx prettier --write \"$file_path\" 2>/dev/null || true;; esac"
    }
  ]
}
```

### 5. TDD 상태 알림 (plan.md 연동)

세션 시작 시 현재 TDD 상태 표시:

```json
{
  "hooks": {
    "SessionStart": [
      {
        "matcher": "startup",
        "hooks": [
          {
            "type": "command",
            "command": "if [ -f \"$CLAUDE_PROJECT_DIR/plan.md\" ]; then echo '📋 현재 TDD 진행 상황:'; grep -E '^- \\[[ x]\\]' \"$CLAUDE_PROJECT_DIR/plan.md\" | head -10; fi"
          }
        ]
      }
    ]
  }
}
```

---

## 통합 설정 파일

`.claude/settings.json`에 적용할 전체 설정:

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "command=$(jq -r '.tool_input.command'); if echo \"$command\" | grep -qE '^git commit'; then cd \"$CLAUDE_PROJECT_DIR\" && rails test --fail-fast 2>/dev/null && rubocop --fail-level E 2>/dev/null || { echo '❌ 테스트 또는 RuboCop 실패' >&2; exit 2; }; fi",
            "timeout": 120000
          }
        ]
      },
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "file_path=$(jq -r '.tool_input.file_path'); if echo \"$file_path\" | grep -qE '\\.env|credentials|master\\.key|secrets'; then echo '❌ 민감 파일 보호됨' >&2; exit 2; fi"
          },
          {
            "type": "command",
            "command": "content=$(jq -r '.tool_input.content // .tool_input.new_string // \"\"'); file_path=$(jq -r '.tool_input.file_path'); if [[ \"$file_path\" == *.rb ]] && echo \"$content\" | grep -qE 'binding\\.pry|debugger|byebug'; then echo '❌ 디버그 코드 제거 필요' >&2; exit 2; fi"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "file_path=$(jq -r '.tool_input.file_path'); if [[ \"$file_path\" == *.rb ]]; then rubocop -a \"$file_path\" 2>/dev/null || true; fi"
          }
        ]
      }
    ],
    "Stop": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "osascript -e 'display notification \"작업 완료\" with title \"Claude Code\" sound name \"Glass\"'"
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "matcher": "startup",
        "hooks": [
          {
            "type": "command",
            "command": "if [ -f \"$CLAUDE_PROJECT_DIR/plan.md\" ]; then echo '📋 TDD 진행 상황:' && grep -E '^- \\[[ x]\\]' \"$CLAUDE_PROJECT_DIR/plan.md\" 2>/dev/null | head -5; fi"
          }
        ]
      }
    ],
    "SessionEnd": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "mkdir -p \"$CLAUDE_PROJECT_DIR/docs/logs\" && LOGFILE=\"$CLAUDE_PROJECT_DIR/docs/logs/$(date +%Y%m%d_%H%M%S).jsonl\" && jq -r '.transcript_path' | xargs -I {} cp {} \"$LOGFILE\" 2>/dev/null && ruby \"$CLAUDE_PROJECT_DIR/scripts/session_to_md.rb\" \"$LOGFILE\" 2>/dev/null || true"
          }
        ]
      }
    ]
  }
}
```

---

## 추천 요약

| Hook | 목적 | 우선순위 |
|------|------|---------|
| **커밋 전 테스트** | TDD 워크플로우 강제 | ⭐⭐⭐ |
| **민감 파일 보호** | .env, credentials 보호 | ⭐⭐⭐ |
| **디버그 코드 차단** | 프로덕션 코드 품질 | ⭐⭐ |
| **TDD 상태 알림** | plan.md 진행 상황 표시 | ⭐⭐ |
| **ERB/JS 포맷팅** | 코드 일관성 | ⭐ |

적용하시겠습니까? 전체 설정을 파일에 저장해드릴 수 있습니다.

---

## 9. 프롬프트

적용해줘

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
사용자가 추천한 hooks 설정을 적용해달라고 요청했습니다. 기존 .claude/settings.json 파일을 업데이트하면 됩니다.
```

</details>



---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
Hooks 설정이 적용되었습니다. 이제 사용자에게 결과를 알려주겠습니다.
```

</details>



---

### 응답

Hooks 설정이 적용되었습니다.

## 적용된 Hooks 요약

| 이벤트 | 동작 |
|--------|------|
| **PreToolUse (Bash)** | `git commit` 전 테스트+RuboCop 실행, 실패 시 차단 |
| **PreToolUse (Write\|Edit)** | 민감 파일(.env, credentials 등) 수정 차단 |
| **PreToolUse (Write\|Edit)** | 디버그 코드(binding.pry 등) 포함 시 차단 |
| **PostToolUse (Write\|Edit)** | Ruby 파일 자동 RuboCop 포맷팅 |
| **Stop** | macOS 알림 (작업 완료) |
| **SessionStart** | plan.md TDD 진행 상황 표시 |
| **SessionEnd** | 세션 로그 저장 |

## 테스트 방법

새 세션을 시작하면 hooks가 적용됩니다:

```bash
# 새 세션 시작
claude

# 또는 현재 세션에서 확인
/hooks
```

**주의:** `git commit` 실행 시 테스트가 돌아가므로 timeout을 120초로 설정했습니다.

---

## 11. 프롬프트

hooks 설정 변경사항 커밋해줘

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
사용자가 hooks 설정 변경사항을 커밋해달라고 요청했습니다. 커밋 가이드에 따라 진행하겠습니다.

먼저 git status와 git diff를 확인하고, 최근 커밋 메시지 스타일을 확인한 후 커밋하겠습니다.
```

</details>



---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
.claude/settings.json이 untracked 파일로 되어 있습니다. 이 파일만 커밋하면 됩니다. hooks 설정 파일이니 chore 타입으로 커밋하겠습니다.
```

</details>



---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
커밋이 성공적으로 완료되었습니다. 사용자에게 결과를 알려주겠습니다.
```

</details>



---

### 응답

커밋 완료되었습니다.

```
d7a76ac chore(hooks): Claude Code hooks 설정 추가
```

**커밋 내용:**
- `.claude/settings.json` 파일 추가 (73줄)
- 7개 hooks 설정 포함

---

## 14. 프롬프트

Claude Code 터미널 상태 표시줄에 컨텍스트 윈도우 사용량을 표시하고 싶어.
요구사항:
1. 진행률 바 형태
2. 사용량에 따라 색상 변경 (초록→노랑→빨강)
3. 남은 퍼센트와 토큰 수 표시 (K 단위)
4. 100% 초과 시 "압축됨" 표시
5. 한글로 출력
~/.claude/settings.json과 statusline.sh 파일 설정해줘.

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
사용자가 Claude Code의 상태줄(statusline)에 컨텍스트 윈도우 사용량을 표시하고 싶어합니다. 이것은 Claude Code의 기능에 대한 질문이므로 먼저 문서를 확인해야 할 수 있습니다.

요구사항:
1. 진행률 바 형태
2. 사용량에 따라 색상 변경 (초록→노랑→빨강)
3. 남은 퍼센트와 토큰 수 표시 (K 단위)
4. 100% 초과 시 "압축됨" 표시
5. 한글로 출력

~/.claude/settings.json과 statusline.sh 파일을 설정해달라고 합니다.

먼저 Claude Code의 statusline 기능에 대해 알아보고, 현재 ~/.claude/settings.json 파일을 확인한 후 설정하겠습니다.
```

</details>



---

### 응답

먼저 Claude Code의 statusline 기능을 확인하겠습니다.

---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
이제 Claude Code statusline에 대한 정보를 얻었습니다. 사용자의 요구사항에 맞게 설정 파일을 만들어야 합니다:

1. 진행률 바 형태
2. 사용량에 따라 색상 변경 (초록→노랑→빨강)
3. 남은 퍼센트와 토큰 수 표시 (K 단위)
4. 100% 초과 시 "압축됨" 표시
5. 한글로 출력

~/.claude/settings.json과 statusline.sh 파일을 설정해야 합니다.

먼저 현재 ~/.claude/settings.json을 확인하고, statusline.sh 스크립트를 작성하겠습니다.
```

</details>



---

### 응답

이제 요구사항에 맞는 statusline을 만들겠습니다.

---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
이제 statusline.sh 스크립트와 settings.json을 업데이트하겠습니다.

요구사항:
1. 진행률 바 형태
2. 사용량에 따라 색상 변경 (초록→노랑→빨강)
   - 0-60%: 초록
   - 60-80%: 노랑
   - 80%+: 빨강
3. 남은 퍼센트와 토큰 수 표시 (K 단위)
4. 100% 초과 시 "압축됨" 표시
5. 한글로 출력

ANSI 색상 코드:
- 초록: \033[32m
- 노랑: \033[33m
- 빨강: \033[31m
- 리셋: \033[0m
```

</details>



---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
이제 스크립트를 실행 가능하게 만들고, settings.json을 업데이트해야 합니다.
```

</details>



---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
이제 스크립트가 제대로 동작하는지 테스트해보겠습니다.
```

</details>



---

### 응답

<details>
<summary>사고 과정 (Thinking)</summary>

```
모든 테스트가 정상적으로 작동합니다. 출력에서 ANSI 코드가 보이지만 실제 터미널에서는 색상으로 표시될 것입니다. 이제 사용자에게 결과를 알려주겠습니다.
```

</details>



---

### 응답

설정 완료되었습니다.

## 적용된 파일

**`~/.claude/settings.json`**
```json
{
  "statusLine": {
    "type": "command",
    "command": "~/.claude/statusline.sh",
    "padding": 0
  }
}
```

**`~/.claude/statusline.sh`** (실행 권한 부여됨)

## 테스트 결과

| 사용량 | 표시 |
|--------|------|
| 10% (20K) | `[Opus] █░░░░░░░░░ 10% (20.0K/200K)` (초록) |
| 65% (130K) | `[Opus] ██████░░░░ 65% (130.0K/200K)` (노랑) |
| 90% (180K) | `[Opus] █████████░ 90% (180.0K/200K)` (빨강) |
| 115% (230K) | `[Opus] ██████████ 100+% (230.0K/200K) 압축됨` (빨강) |

## 색상 기준

| 사용량 | 색상 |
|--------|------|
| 0-59% | 🟢 초록 |
| 60-79% | 🟡 노랑 |
| 80%+ | 🔴 빨강 |

새 세션을 시작하면 하단 상태줄에 표시됩니다.

---


*이 문서는 Claude Code 세션에서 자동 생성되었습니다.*
