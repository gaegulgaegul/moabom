<%# Frame0 Sketch Design System - Profile Settings %>
<%= render Sketch::ContainerComponent.new(padding: :md, variant: :paper) do %>
  <h1 class="text-xl font-sketch font-bold text-sketch-ink mb-6"><%= t('.title') %></h1>

  <!-- 계정 설정 -->
  <%= render Sketch::CardComponent.new(variant: :default, padding: :md, class: "mb-6") do %>
    <div class="divide-y-2 divide-dashed divide-sketch-cream -mx-4">
      <div class="px-4">
        <%= render "settings/setting_item", icon: "circle-user", title: "프로필 설정", url: "#" %>
      </div>
      <div class="px-4">
        <%= render "settings/setting_item", icon: "bell", title: "알림 설정", url: settings_notifications_path %>
      </div>
      <div class="px-4">
        <%= render "settings/setting_item", icon: "moon", title: "다크 모드" do %>
          <button class="w-12 h-7 bg-sketch-cream rounded-full relative transition-colors border-2 border-sketch-gray"
                  data-controller="toggle"
                  data-action="click->toggle#toggle">
            <span class="absolute left-1 top-0.5 w-5 h-5 bg-sketch-paper rounded-full shadow transition-transform"
                  data-toggle-target="knob"></span>
          </button>
        <% end %>
      </div>
    </div>
  <% end %>

  <!-- 프로필 수정 폼 -->
  <%= render Sketch::CardComponent.new(variant: :default, padding: :lg, class: "mb-6") do %>
    <h2 class="text-lg font-sketch font-semibold text-sketch-ink mb-4">프로필 정보</h2>

    <%= form_with model: current_user, url: settings_profile_path, method: :patch, class: "space-y-4" do |form| %>
      <% if current_user.errors.any? %>
        <%= render Sketch::AlertComponent.new(variant: :error, dismissible: false) do %>
          <% current_user.errors.full_messages.each do |message| %>
            <p class="text-sm"><%= message %></p>
          <% end %>
        <% end %>
      <% end %>

      <div>
        <label class="block text-sm font-sketch font-medium text-sketch-ink mb-2"><%= User.human_attribute_name(:email) %></label>
        <%= form.email_field :email, disabled: true, class: "w-full px-4 py-3 bg-sketch-cream border-2 border-sketch-gray rounded-xl font-hand text-sketch-gray cursor-not-allowed" %>
        <p class="text-xs font-hand text-sketch-gray mt-1"><%= t('.email_help') %></p>
      </div>

      <%= render Sketch::InputComponent.new(
        name: "user[nickname]",
        label: User.human_attribute_name(:nickname),
        value: current_user.nickname
      ) %>

      <%= render Sketch::ButtonComponent.new(variant: :primary, type: :submit, full_width: true) do %>
        <%= t('helpers.submit.save') %>
      <% end %>
    <% end %>
  <% end %>

  <!-- 정보 -->
  <%= render Sketch::CardComponent.new(variant: :default, padding: :md, class: "mb-6") do %>
    <div class="divide-y-2 divide-dashed divide-sketch-cream -mx-4">
      <div class="px-4">
        <%= render "settings/setting_item", icon: "file-text", title: "이용약관", url: "#" %>
      </div>
      <div class="px-4">
        <%= render "settings/setting_item", icon: "shield-check", title: "개인정보 처리방침", url: "#" %>
      </div>
      <div class="px-4">
        <%= render "settings/setting_item", icon: "info", title: "앱 정보", url: "#", value: "v1.0.0" %>
      </div>
    </div>
  <% end %>

  <!-- 로그아웃 -->
  <%= render Sketch::CardComponent.new(variant: :default, padding: :md) do %>
    <%= button_to logout_path, method: :delete, class: "flex items-center gap-3 py-4 w-full tap-highlight-none hover:bg-sketch-cream transition-colors -mx-4 px-4" do %>
      <%= lucide_icon "log-out", class: "w-6 h-6 text-red-500" %>
      <span class="font-sketch text-red-500">로그아웃</span>
    <% end %>
  <% end %>
<% end %>
