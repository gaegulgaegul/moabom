<%# Frame0 Sketch Design System - Photo Timeline %>
<%= render Sketch::ContainerComponent.new(padding: :md, variant: :paper) do %>
  <!-- 헤더 -->
  <h1 class="text-xl font-sketch font-bold text-sketch-ink mb-4">사진 타임라인</h1>

  <!-- 필터 탭 -->
  <div class="flex gap-2 mb-6 overflow-x-auto scrollbar-hide -mx-4 px-4">
    <%= link_to family_photos_path(@family),
        class: "shrink-0 px-4 py-2 rounded-xl border-2 text-sm font-sketch font-medium transition-colors
                #{params[:child_id].blank? ? 'bg-sketch-ink text-sketch-paper border-sketch-ink' : 'bg-sketch-cream text-sketch-gray border-sketch-gray'}" do %>
      전체
    <% end %>
    <% @family.children.each do |child| %>
      <%= link_to family_photos_path(@family, child_id: child.id),
          class: "shrink-0 px-4 py-2 rounded-xl border-2 text-sm font-sketch font-medium transition-colors
                  #{params[:child_id].to_s == child.id.to_s ? 'bg-sketch-ink text-sketch-paper border-sketch-ink' : 'bg-sketch-cream text-sketch-gray border-sketch-gray'}" do %>
        <%= child.name %>
      <% end %>
    <% end %>
  </div>

  <% if @photos.any? %>
    <!-- 월별 그룹 -->
    <% @photos.group_by { |p| p.taken_at.strftime("%Y년 %m월") }.each do |month, photos| %>
      <section class="mb-8">
        <div class="flex items-center justify-between mb-3">
          <h2 class="text-sm font-sketch font-semibold text-sketch-gray"><%= month %></h2>
          <%= render Sketch::BadgeComponent.new(variant: :secondary, size: :sm) do %>
            <%= photos.count %>장
          <% end %>
        </div>
        <%= render "families/photos/photo_grid", photos: photos, family: @family %>
      </section>
    <% end %>
  <% else %>
    <!-- 빈 상태 -->
    <%= render Sketch::EmptyStateComponent.new(
      icon: "image",
      title: "아직 사진이 없어요",
      description: "소중한 순간을 가족과 공유해보세요",
      action_text: "첫 사진 업로드",
      action_href: new_family_photo_path(@family),
      size: :md
    ) %>
  <% end %>
<% end %>
