# CodeRabbit Configuration
# https://docs.coderabbit.ai/guides/configure-coderabbit

language: ko-KR

early_access: false

reviews:
  # ë¦¬ë·° ìŠ¤íƒ€ì¼: chill, assertive, nitpicky
  profile: assertive

  # ë¦¬ë·° ìš”ì²­ ì„¤ì •
  request_changes_workflow: false
  high_level_summary: true
  high_level_summary_placeholder: "@coderabbitai summary"

  # ìë™ ë¦¬ë·°
  auto_review:
    enabled: true
    drafts: false
    base_branches:
      - main

  # ë¦¬ë·° ì œì™¸ ê²½ë¡œ
  path_filters:
    - "!**/*.lock"
    - "!**/node_modules/**"
    - "!**/vendor/**"
    - "!db/schema.rb"
    - "!config/credentials.yml.enc"
    - "!tmp/**"
    - "!log/**"
    - "!storage/**"
    - "!public/assets/**"

  # ë¦¬ë·° ë„êµ¬ ì„¤ì •
  tools:
    rubocop:
      enabled: true
    shellcheck:
      enabled: true
    markdownlint:
      enabled: true

  # ê²½ë¡œë³„ ë¦¬ë·° ì§€ì¹¨
  path_instructions:
    - path: "**/*"
      instructions: |
        ## ğŸŒ ì–¸ì–´ ì„¤ì • (CRITICAL)
        ëª¨ë“  ë¦¬ë·° ì½”ë©˜íŠ¸ëŠ” **ë°˜ë“œì‹œ í•œêµ­ì–´ë¡œ ì‘ì„±**í•´ì•¼ í•©ë‹ˆë‹¤.

        ## ì»¤ë°‹ ì»¨ë²¤ì…˜
        - íƒ€ì…: feat/fix/refactor/test/docs/chore
        - êµ¬ì¡°ì  ë³€ê²½(refactor)ê³¼ ë™ì‘ì  ë³€ê²½(feat/fix)ì€ ë°˜ë“œì‹œ ë¶„ë¦¬

    - path: "**/*.rb"
      instructions: |
        ## Ruby ì½”ë“œ ìŠ¤íƒ€ì¼
        - ë“¤ì—¬ì“°ê¸°: 2 spaces
        - ë©”ì„œë“œ/ë³€ìˆ˜: snake_case, í´ë˜ìŠ¤: PascalCase
        - guard clause ì„ í˜¸
        - safe navigation operator (&.) ì‚¬ìš©

    - path: "app/controllers/**/*.rb"
      instructions: |
        ## Controller ë¦¬ë·° ì§€ì¹¨
        - ControllerëŠ” thiní•˜ê²Œ ìœ ì§€
        - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ Serviceë¡œ ë¶„ë¦¬
        - Strong Parameters í•„ìˆ˜
        - ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ì€ ë°˜ë“œì‹œ current_user scope í†µí•´ì„œ
        - N+1 ì¿¼ë¦¬ ë°©ì§€ (includes ì‚¬ìš©)

    - path: "app/models/**/*.rb"
      instructions: |
        ## Model ë¦¬ë·° ì§€ì¹¨
        - validation, association, scopeë§Œ í¬í•¨
        - ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ Serviceë¡œ ë¶„ë¦¬
        - N+1 ì¿¼ë¦¬ ë°©ì§€ (includes, preload ì‚¬ìš©)

    - path: "app/services/**/*.rb"
      instructions: |
        ## Service ë¦¬ë·° ì§€ì¹¨
        - ë‹¨ì¼ ì±…ì„ ì›ì¹™ ì¤€ìˆ˜
        - Result ê°ì²´ ë°˜í™˜ ê¶Œì¥
        - íŠ¸ëœì­ì…˜ ì²˜ë¦¬ í™•ì¸

    - path: "app/views/**/*.erb"
      instructions: |
        ## View ë³´ì•ˆ ë¦¬ë·°
        - XSS ë°©ì§€: ì‚¬ìš©ì ì…ë ¥ì€ ë°˜ë“œì‹œ escape
        - raw/html_safe ì‚¬ìš© ì‹œ ì£¼ì˜

    - path: "test/**/*.rb"
      instructions: |
        ## í…ŒìŠ¤íŠ¸ ë¦¬ë·° ì§€ì¹¨
        - TDD ì›Œí¬í”Œë¡œìš° (Red-Green-Refactor) ì¤€ìˆ˜
        - ëª¨ë“  public ë©”ì„œë“œì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ í•„ìˆ˜
        - ì˜ë¯¸ ìˆëŠ” í…ŒìŠ¤íŠ¸ëª… ì‚¬ìš©
        - í…ŒìŠ¤íŠ¸ ë…ë¦½ì„± í™•ì¸

    - path: "db/migrate/**/*.rb"
      instructions: |
        ## Migration ë¦¬ë·° ì§€ì¹¨
        - ë¡¤ë°± ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
        - ì¸ë±ìŠ¤ ì¶”ê°€ í™•ì¸
        - ëŒ€ìš©ëŸ‰ í…Œì´ë¸” ë³€ê²½ ì‹œ ì£¼ì˜

chat:
  auto_reply: true
